# Frontend API Client Specification
**Todo App – Hackathon II – Phase II**

**Version**: 1.0
**Status**: Effective
**Governing Specs**:
- `.specify/memory/constitution.md` - Supreme authority
- `/specs/ui/frontend-architecture.md` - Frontend architecture
- `/specs/api/rest-endpoints.md` - Backend API contracts
- `/specs/skills/frontend-api-client-skill.md` - API client generation logic

---

## 1. Purpose of API Client

This specification defines the architecture, boundaries, and responsibilities of the frontend API client for Todo App Phase II. The API client is the single source of truth for all backend communication, centralizing HTTP requests, authentication token management, error handling, and data transformation.

**Primary Objectives:**
- Provide type-safe interface to all backend endpoints
- Automate JWT token attachment to requests
- Centralize error handling and retry logic
- Transform data between frontend (camelCase) and backend (snake_case)
- Enforce multi-user data isolation
- Provide consistent API response formats

**Non-Objectives:**
- This is NOT an implementation guide (use Frontend API Client Skill for code generation)
- This does NOT contain fetch/axios implementation details
- This does NOT define backend endpoint implementations

---

## 2. Relationship with Constitution, Skills & Agents

### 2.1 Constitution Compliance

**From `.specify/memory/constitution.md`:**
- **Spec-Driven Development**: API client must reference `/specs/api/rest-endpoints.md`
- **Zero Manual Coding**: API client generated by Frontend API Client Skill
- **Multi-User Isolation**: All requests must include user_id from JWT token
- **Security First**: JWT tokens attached to all protected requests
- **Technology Stack**: TypeScript with type hints, native Fetch API

### 2.2 Skill Responsibilities

**Frontend API Client Skill** (`/specs/skills/frontend-api-client-skill.md`):
- Generates API client functions
- Designs request/response data transformation
- Implements JWT token attachment logic
- Defines error handling strategies

**Frontend Form Handling Skill**:
- Validates form data before API calls
- Formats form data for API client consumption

**Task Business Logic Skill** (`/specs/skills/task-business-logic-skill.md`):
- Validates task data per business rules
- Enforces state transitions
- Provides validation error messages

**Frontend Notification Skill**:
- Displays error messages from API responses
- Shows success notifications

### 2.3 Agent Orchestration

**Frontend Implementation Agent**:
- Invokes Frontend API Client Skill
- Generates API client code (`/lib/api.ts`)
- Implements TypeScript interfaces for requests/responses
- Integrates API client with components

**Plan Agent**:
- Designs API client architecture
- Determines data transformation rules
- Plans error handling strategy

---

## 3. API Client Architecture

### 3.1 Client Structure

```
/lib/api.ts (API Client Module)
├── Base Configuration
│   ├── Base URL (from env var)
│   ├── Default headers
│   └── Timeout settings
├── Token Management
│   ├── Get token from localStorage
│   ├── Attach token to Authorization header
│   └── Handle missing/invalid tokens
├── Request Transformation
│   ├── camelCase → snake_case (request data)
│   ├── Date → ISO 8601 string
│   └── Boolean → string (if needed)
├── Response Transformation
│   ├── snake_case → camelCase (response data)
│   ├── ISO 8601 string → Date
│   └── String → Boolean (if needed)
├── Error Handling
│   ├── Parse error responses
│   ├── Categorize errors (network, client, server)
│   ├── Return standardized error objects
│   └── Handle 401 Unauthorized (clear token, redirect)
└── API Functions (by resource)
    ├── Auth API
    │   ├── register()
    │   └── login()
    └── Tasks API
        ├── getTasks()
        ├── getTask()
        ├── createTask()
        ├── updateTask()
        ├── deleteTask()
        └── toggleTaskComplete()
```

### 3.2 Request/Response Flow

**Request Flow:**
```
Component
  ↓
Calls API Client Function
  ↓
API Client
  ├─ Retrieves JWT token from localStorage
  ├─ Attaches token to Authorization header
  ├─ Transforms request data (camel → snake)
  ├─ Constructs HTTP request
  ├─ Sends request to backend
  └─ Handles errors/returns response
  ↓
Backend (FastAPI)
  ├─ Validates JWT token
  ├─ Validates user ownership
  ├─ Processes request
  └─ Returns response
  ↓
API Client
  ├─ Parses response
  ├─ Transforms response data (snake → camel)
  └─ Returns typed data/error to component
  ↓
Component
  ├─ Updates state with data
  └─ Displays error or success
```

### 3.3 Type Safety

**TypeScript Interfaces for All Contracts:**
- Request body interfaces (for POST, PATCH)
- Query parameter interfaces (for GET)
- Response data interfaces (for all responses)
- Error response interfaces (for error handling)

---

## 4. State Ownership Boundaries

### 4.1 API Client DOES NOT Manage State

**API Client Responsibilities:**
- Send HTTP requests to backend
- Attach JWT tokens to requests
- Transform request/response data
- Parse error responses
- Return typed data or errors

**API Client Does NOT:**
- Store task list (state management responsibility)
- Manage form field values (component responsibility)
- Manage loading state (component responsibility)
- Manage modal open/close state (component responsibility)
- Manage notification state (ToastProvider responsibility)
- Cache API responses (optional enhancement, not Phase II)

### 4.2 State Owner: Components

**Component Responsibilities:**
- Call API client functions
- Manage local loading state (during API calls)
- Manage local error state (display errors)
- Update component state with API responses
- Display success/error notifications (via ToastProvider)

**Example:**
```typescript
// Component manages state
const [tasks, setTasks] = useState<Task[]>([]);
const [loading, setLoading] = useState(false);
const [error, setError] = useState<string | null>(null);

// Component calls API client
const fetchTasks = async () => {
  setLoading(true);
  setError(null);
  try {
    const data = await api.getTasks(filters);
    setTasks(data);
  } catch (err) {
    setError(err.message);
    showToast('Failed to load tasks', 'error');
  } finally {
    setLoading(false);
  }
};
```

### 4.3 State Owner: Context Providers

**AuthProvider Responsibilities:**
- Store JWT token (from API response)
- Store user data (from API response)
- Provide token to API client via localStorage
- Clear token on logout

**ToastProvider Responsibilities:**
- Store active toasts
- Provide showToast() method to components
- Display notifications

---

## 5. API Endpoints

### 5.1 Authentication Endpoints

#### POST /api/auth/register

**Purpose**: Register new user

**Skill Responsible**:
- Frontend API Client Skill (creates register() function)
- Frontend Form Handling Skill (validates registration form)

**Agent Responsible**:
- Frontend Implementation Agent (creates register function in API client)

**Request Data Type**: `RegisterRequest`
- `email: string` (required, valid email format)
- `name: string` (required, max 255 characters)
- `password: string` (required, min 8 characters)

**Response Data Type**: `RegisterResponse`
- `id: number` - User ID
- `email: string` - User email
- `name: string` - User name
- `created_at: string` - ISO 8601 datetime

**Error Handling Rules**:
- **400 Bad Request**: Show field-specific validation errors
- **409 Conflict**: Email already exists
- **500 Server Error**: Show generic error message with retry option

---

#### POST /api/auth/login

**Purpose**: Authenticate user

**Skill Responsible**:
- Frontend API Client Skill (creates login() function)
- Frontend Form Handling Skill (validates login form)

**Agent Responsible**:
- Frontend Implementation Agent (creates login function in API client)

**Request Data Type**: `LoginRequest`
- `email: string` (required)
- `password: string` (required)

**Response Data Type**: `LoginResponse`
- `access_token: string` - JWT token
- `token_type: string` - "bearer"
- `user: object` - User data
  - `id: number` - User ID
  - `email: string` - User email
  - `name: string` - User name

**Error Handling Rules**:
- **400 Bad Request**: Invalid credentials
- **401 Unauthorized**: Email/password incorrect (show error message)
- **500 Server Error**: Show generic error message with retry option

**Token Storage**:
- API client stores `access_token` in `localStorage.getItem('auth_token')`
- AuthProvider loads token on app mount
- Subsequent requests attach token to Authorization header

---

### 5.2 Task Endpoints

#### GET /api/{user_id}/tasks

**Purpose**: Fetch all tasks for authenticated user

**Skill Responsible**:
- Frontend API Client Skill (creates getTasks() function)
- Task Business Logic Skill (validates response)

**Agent Responsible**:
- Frontend Implementation Agent (creates getTasks function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token

**Query Parameters** (Optional):
- `status: 'all' | 'pending' | 'completed'` - Filter by status
- `priority: 'all' | 'high' | 'medium' | 'low'` - Filter by priority
- `category: string` - Filter by category
- `search: string` - Keyword search in title/description
- `sort_by: 'priority' | 'title' | 'created_at'` - Sort field
- `sort_order: 'asc' | 'desc'` - Sort direction

**Response Data Type**: `Task[]` - Array of task objects
- `id: number` - Task ID
- `title: string` - Task title
- `description?: string` - Task description
- `status: 'pending' | 'completed'` - Task status
- `priority: 'high' | 'medium' | 'low'` - Task priority
- `category?: string` - Task category
- `user_id: number` - User ID (owner)
- `created_at: string` - ISO 8601 datetime
- `updated_at: string` - ISO 8601 datetime
- `completed_at?: string` - ISO 8601 datetime (null if not completed)

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend filters tasks by `user_id`
- Client only receives user's own tasks

**Error Handling Rules**:
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error (should not happen)
- **500 Server Error**: Show generic error message with retry option

---

#### POST /api/{user_id}/tasks

**Purpose**: Create new task

**Skill Responsible**:
- Frontend API Client Skill (creates createTask() function)
- Frontend Form Handling Skill (validates task form)
- Task Business Logic Skill (validates business rules)

**Agent Responsible**:
- Frontend Implementation Agent (creates createTask function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token

**Request Data Type**: `CreateTaskRequest`
- `title: string` (required)
- `description?: string` (optional)
- `priority?: 'high' | 'medium' | 'low'` (default: medium)
- `category?: string` (optional)

**Response Data Type**: `Task` - Created task object (includes generated id and timestamps)

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend assigns `user_id` to created task
- Backend enforces ownership

**Error Handling Rules**:
- **400 Bad Request**: Show field-specific validation errors (title length, etc.)
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error message
- **422 Unprocessable Entity**: Show validation errors
- **500 Server Error**: Show generic error message with retry option

---

#### GET /api/{user_id}/tasks/{id}

**Purpose**: Fetch specific task

**Skill Responsible**:
- Frontend API Client Skill (creates getTask() function)
- Task Business Logic Skill (validates ownership)

**Agent Responsible**:
- Frontend Implementation Agent (creates getTask function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token
- `id: number` - Task ID to fetch

**Response Data Type**: `Task` - Task object

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend validates task belongs to user
- Backend enforces isolation

**Error Handling Rules**:
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error message (user doesn't own task)
- **404 Not Found**: Show error message (task not found)
- **500 Server Error**: Show generic error message with retry option

---

#### PUT /api/{user_id}/tasks/{id}

**Purpose**: Update task (full update)

**Skill Responsible**:
- Frontend API Client Skill (creates updateTask() function)
- Frontend Form Handling Skill (validates task form)
- Task Business Logic Skill (validates business rules)

**Agent Responsible**:
- Frontend Implementation Agent (creates updateTask function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token
- `id: number` - Task ID to update

**Request Data Type**: `UpdateTaskRequest` (all fields required)
- `title: string` (required)
- `description?: string` (optional)
- `status: 'pending' | 'completed'` (required)
- `priority: 'high' | 'medium' | 'low'` (required)
- `category?: string` (optional)

**Response Data Type**: `Task` - Updated task object

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend validates task belongs to user
- Backend enforces isolation

**Error Handling Rules**:
- **400 Bad Request**: Show field-specific validation errors
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error message (user doesn't own task)
- **404 Not Found**: Show error message (task not found)
- **422 Unprocessable Entity**: Show validation errors
- **500 Server Error**: Show generic error message with retry option

---

#### DELETE /api/{user_id}/tasks/{id}

**Purpose**: Delete task

**Skill Responsible**:
- Frontend API Client Skill (creates deleteTask() function)
- Task Business Logic Skill (validates ownership)

**Agent Responsible**:
- Frontend Implementation Agent (creates deleteTask function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token
- `id: number` - Task ID to delete

**Response Data Type**: `null` - 204 No Content

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend validates task belongs to user
- Backend enforces isolation

**Error Handling Rules**:
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error message (user doesn't own task)
- **404 Not Found**: Show error message (task not found)
- **500 Server Error**: Show generic error message with retry option

---

#### PATCH /api/{user_id}/tasks/{id}/complete

**Purpose**: Toggle task completion status

**Skill Responsible**:
- Frontend API Client Skill (creates toggleTaskComplete() function)
- Task Business Logic Skill (validates state transition)

**Agent Responsible**:
- Frontend Implementation Agent (creates toggleTaskComplete function in API client)

**Path Parameters**:
- `user_id: number` - Extracted from JWT token
- `id: number` - Task ID to toggle

**Request Data Type**: None (empty body)

**Response Data Type**: `Task` - Updated task object

**Multi-User Isolation**:
- Client MUST include `user_id` from JWT token in path
- Backend validates task belongs to user
- Backend enforces isolation

**Error Handling Rules**:
- **401 Unauthorized**: Clear token, redirect to login
- **403 Forbidden**: Show error message (user doesn't own task)
- **404 Not Found**: Show error message (task not found)
- **422 Unprocessable Entity**: Invalid state transition
- **500 Server Error**: Show generic error message with retry option

---

## 6. Interaction Rules

### 6.1 Components MUST Call API Via Client Only

**Forbidden Patterns:**
- NO direct `fetch()` calls in components
- NO direct `axios.get()` calls in components
- NO HTTP requests outside API client
- NO backend communication without API client

**Required Pattern:**
```typescript
// Components MUST use API client
import api from '@/lib/api';

const tasks = await api.getTasks(filters);
```

**Allowed Patterns:**
- ✅ `api.getTasks(params)` - Correct
- ✅ `api.createTask(data)` - Correct
- ❌ `fetch('/api/123/tasks')` - Forbidden
- ❌ `axios.get('/api/123/tasks')` - Forbidden

### 6.2 Request Flow

```
Component
  ↓
  Calls API client function
  ↓
    api.getTasks(params)
  ↓
API Client
  ├─ Retrieves JWT token from localStorage
  ├─ Attaches token to Authorization header
  ├─ Constructs request (method, URL, headers, body)
  ├─ Sends request to backend
  └─ Handles errors/returns response
  ↓
Backend (FastAPI)
  ├─ Validates JWT token
  ├─ Extracts user_id from token
  ├─ Validates user_id matches path parameter
  ├─ Processes request (CRUD operation)
  └─ Returns response (data or error)
  ↓
API Client
  ├─ Parses response (status code, body)
  ├─ Transforms response data (snake_case → camelCase)
  ├─ Returns typed data to component
  └─ Or returns standardized error object
  ↓
Component
  ├─ Updates state with data
  ├─ Shows loading state
  ├─ Shows error or success message
  └─ Re-renders UI
```

---

## 7. Data Transformation Rules

### 7.1 Request Transformation (Frontend → Backend)

**Purpose**: Convert frontend camelCase to backend snake_case

**Transformation Rules:**
- **camelCase → snake_case**: `userId` → `user_id`
- **Date → ISO 8601**: `new Date()` → `"2026-01-02T00:00:00Z"`
- **Boolean → string**: `true` → `"true"` (if backend expects string)

**Examples:**
```typescript
// Frontend format
{
  userId: 123,
  taskTitle: "Buy groceries",
  isCompleted: false,
  dueDate: new Date()
}

// Backend format (after transformation)
{
  user_id: 123,
  task_title: "Buy groceries",
  is_completed: false,
  due_date: "2026-01-05T00:00:00Z"
}
```

### 7.2 Response Transformation (Backend → Frontend)

**Purpose**: Convert backend snake_case to frontend camelCase

**Transformation Rules:**
- **snake_case → camelCase**: `user_id` → `userId`
- **ISO 8601 → Date**: `"2026-01-02T10:00:00Z"` → `new Date()`
- **String → Boolean**: `"true"` → `true` (if backend returns string)
- **Null/undefined handling**: Keep nulls/undefined as-is

**Examples:**
```typescript
// Backend format
{
  user_id: 123,
  task_title: "Buy groceries",
  is_completed: false,
  due_date: "2026-01-05T00:00:00Z",
  created_at: "2026-01-02T10:00:00Z"
}

// Frontend format (after transformation)
{
  id: 1,
  userId: 123,
  taskTitle: "Buy groceries",
  isCompleted: false,
  dueDate: new Date("2026-01-05T00:00:00Z"),
  createdAt: new Date("2026-01-02T10:00:00Z")
}
```

---

## 8. Error Handling Architecture

### 8.1 Error Response Format

**Backend Error Response:**
```typescript
interface ApiErrorResponse {
  detail: string;           // User-friendly error message
  error_code?: string;      // Error code for programmatic handling
  field?: string;           // Field with error (for validation errors)
  timestamp: string;        // ISO 8601 datetime
}
```

**Frontend Error Object:**
```typescript
interface ApiError {
  message: string;          // User-friendly message
  code?: string;           // Error code
  field?: string;          // Field with error (for forms)
  status: number;          // HTTP status code
  isAuthError: boolean;    // True for 401
  isAuthzError: boolean;   // True for 403
  isValidationError: boolean; // True for 400/422
  isServerError: boolean;  // True for 500+
}
```

### 8.2 Error Categorization

**Network Errors:**
- No internet connection
- DNS failure
- Request timeout
- Action: Show offline/error message, retry with exponential backoff

**Client Errors (4xx):**
- **400 Bad Request**: Invalid request data
  - Action: Show field-specific errors
- **401 Unauthorized**: Missing or invalid token
  - Action: Clear token, redirect to login
- **403 Forbidden**: Access denied (wrong user)
  - Action: Show error message
- **404 Not Found**: Resource doesn't exist
  - Action: Show error message or return null
- **422 Unprocessable Entity**: Validation errors
  - Action: Show field-level errors

**Server Errors (5xx):**
- **500 Internal Server Error**: Unexpected server error
  - Action: Show generic error message with retry option
- **502/503/504**: Service unavailable
  - Action: Show error message, retry with exponential backoff

---

## 9. Token Management

### 9.1 Token Storage

**Location**: `localStorage.getItem('auth_token')`

**Storage Logic:**
- Login response: Store `access_token` in localStorage
- All subsequent requests: Retrieve token from localStorage
- Logout: Remove token from localStorage

**Client-Side Check:**
```typescript
const token = localStorage.getItem('auth_token');
if (token) {
  headers['Authorization'] = `Bearer ${token}`;
}
```

**Client Responsibilities:**
- Check token presence before request
- Return 401 error if token missing (for protected endpoints)
- Do NOT validate token signature (backend responsibility)

**Backend Responsibilities:**
- Validate token signature
- Check token expiration
- Extract user_id from token claims

### 9.2 Token Expiration Handling

**401 Response Flow:**
```
API Client
  ├─ Receives 401 response
  ├─ Clears token from localStorage
  │   localStorage.removeItem('auth_token')
  ├─ Updates AuthContext
  │   authContext.logout()
  └─ Redirects to login page
      router.push('/login')
```

**Token Refresh:**
- Phase II: No automatic token refresh
- User must re-login on token expiration
- Future Phase III+: Implement automatic refresh with refresh token

---

## 10. Multi-User Isolation Enforcement

### 10.1 User ID Extraction

**Source**: JWT token claims

**Extraction Logic:**
- Backend extracts `user_id` from JWT token
- Backend verifies `user_id` matches request path parameter
- Frontend includes `user_id` in request path for clarity

**Client-Side Check** (sanity only):
```typescript
const userIdFromToken = decodeJWT(token).userId;
const userIdFromPath = pathParams.user_id;
if (userIdFromToken !== userIdFromPath) {
  // This should never happen if UI is correct
  throw new Error('User ID mismatch');
}
```

### 10.2 User ID in Requests

**All task endpoints include `user_id` in path:**

**GET**: `GET /api/{user_id}/tasks`
**POST**: `POST /api/{user_id}/tasks`
**PUT/PATCH/DELETE**: `PUT/PATCH/DELETE /api/{user_id}/tasks/{id}`

**Backend Validation:**
1. Validate JWT token signature
2. Extract `user_id` from token claims
3. Compare `user_id` (from token) with `user_id` (from path)
4. Reject if mismatch (403 Forbidden)
5. Filter/validate data for that user only

### 10.3 Isolation Enforcement

**Frontend:**
- Never request other users' tasks
- Never send other users' IDs in requests
- Validate `user_id` matches authenticated user (sanity check)

**Backend:**
- Enforce `user_id` in all queries
- Validate token ownership
- Reject cross-user access attempts (403 Forbidden)

---

## 11. TypeScript Type Definitions

### 11.1 Request Types

**Auth Request Types:**
```typescript
interface RegisterRequest {
  email: string;      // required
  name: string;       // required
  password: string;   // required
}

interface LoginRequest {
  email: string;      // required
  password: string;   // required
}
```

**Task Request Types:**
```typescript
interface CreateTaskRequest {
  title: string;          // required
  description?: string;   // optional
  priority?: 'high' | 'medium' | 'low'; // default: medium
  category?: string;      // optional
}

interface UpdateTaskRequest {
  title: string;          // required
  description?: string;   // optional
  status: 'pending' | 'completed';
  priority: 'high' | 'medium' | 'low';
  category?: string;      // optional
}

interface GetTasksQuery {
  status?: 'all' | 'pending' | 'completed';
  priority?: 'all' | 'high' | 'medium' | 'low';
  category?: string;
  search?: string;
  sort_by?: 'priority' | 'title' | 'created_at';
  sort_order?: 'asc' | 'desc';
}
```

### 11.2 Response Types

**Auth Response Types:**
```typescript
interface RegisterResponse {
  id: number;
  email: string;
  name: string;
  created_at: string; // ISO 8601 datetime
}

interface LoginResponse {
  access_token: string;
  token_type: string; // "bearer"
  user: {
    id: number;
    email: string;
    name: string;
  };
}
```

**Task Response Types:**
```typescript
interface Task {
  id: number;
  title: string;
  description?: string;
  status: 'pending' | 'completed';
  priority: 'high' | 'medium' | 'low';
  category?: string;
  user_id: number;
  created_at: string;     // ISO 8601 datetime
  updated_at: string;     // ISO 8601 datetime
  completed_at?: string; // ISO 8601 datetime (null if not completed)
}
```

### 11.3 Error Types

**Backend Error Response:**
```typescript
interface ApiErrorResponse {
  detail: string;
  error_code?: string;
  field?: string;
  timestamp: string;
}
```

**Frontend Error Object:**
```typescript
interface ApiError {
  message: string;
  code?: string;
  field?: string;
  status: number;
  isAuthError: boolean;
  isAuthzError: boolean;
  isValidationError: boolean;
  isServerError: boolean;
}
```

---

## 12. API Client Function Signatures

### 12.1 Auth API

```typescript
interface AuthAPI {
  register(data: RegisterRequest): Promise<RegisterResponse>;
  login(data: LoginRequest): Promise<LoginResponse>;
}
```

### 12.2 Tasks API

```typescript
interface TasksAPI {
  getTasks(query?: GetTasksQuery): Promise<Task[]>;
  getTask(taskId: number): Promise<Task>;
  createTask(data: CreateTaskRequest): Promise<Task>;
  updateTask(taskId: number, data: UpdateTaskRequest): Promise<Task>;
  deleteTask(taskId: number): Promise<void>;
  toggleTaskComplete(taskId: number): Promise<Task>;
}
```

---

## 13. Compliance with Governing Specs

### 13.1 Constitution Compliance

- **Spec-Driven Development**: All API functions reference `/specs/api/rest-endpoints.md`
- **Zero Manual Coding**: API client generated by Frontend API Client Skill
- **Multi-User Isolation**: All requests include `user_id` from JWT token
- **Security First**: JWT tokens attached to all protected requests
- **Technology Stack**: TypeScript with type hints, native Fetch API

### 13.2 Skill Compliance

**Frontend API Client Skill**:
- Follows skill specification for request/response transformation
- Implements JWT token attachment
- Implements error handling per skill design
- Provides type-safe API functions

**Frontend Form Handling Skill**:
- Validates form data before API calls
- Formats data for API client consumption

**Task Business Logic Skill**:
- Validates task data per business rules
- Enforces state transitions
- Provides validation error messages

### 13.3 Architecture Compliance

**Frontend Architecture (`/specs/ui/frontend-architecture.md`):**
- API client in `/lib/api.ts` (centralized location)
- All API calls go through API client only
- JWT token management integrated with AuthProvider
- Error handling standardized across all requests

**Frontend Components Spec (`/specs/ui/components.md`):**
- Components call API client functions
- Components manage local loading/error states
- Components display errors via ToastProvider

---

## 14. Evolution Path

### 14.1 Phase II Current Scope

**Implemented:**
- All authentication endpoints (register, login)
- All task CRUD endpoints (GET, POST, PUT, DELETE, PATCH)
- JWT token attachment
- Request/response data transformation (camelCase ↔ snake_case)
- Error handling and categorization
- Multi-user data isolation

**Features:**
- Type-safe API functions
- Standardized error responses
- Token storage in localStorage
- 401 unauthorized handling (clear token, redirect)

### 14.2 Future Enhancements (Phase III+)

**Additional Features:**
- Automatic token refresh with refresh token
- API response caching (with React Query or SWR)
- Optimistic updates (add to list before API response)
- Request cancellation (AbortController)
- Request retry with exponential backoff
- File upload support (for attachments)
- WebSocket client (for real-time updates)
- Request batching (multiple operations in single request)
- GraphQL API client (if backend migrates to GraphQL)

**Enhanced Features:**
- Request/response logging (development only)
- Request timing metrics
- Error reporting to monitoring service
- Request deduplication
- Offline support (service worker)

---

**Version History:**
- **v1.0** (2026-01-02): Initial frontend API client specification for Phase II
